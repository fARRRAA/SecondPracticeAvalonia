<Window xmlns="https://github.com/avaloniaui"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
		xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
		xmlns:data="clr-namespace:Srez.Data"
		mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="700"
		x:Class="Srez.MainWindow"
		Title="Управление материалами"
		Width="1200" Height="700"
		Loaded="Window_Loaded">
	<DockPanel>
		<Border DockPanel.Dock="Top" Background="#ABCFCE" Padding="16">
			<Grid ColumnDefinitions="Auto,*,Auto" VerticalAlignment="Center">
				<StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
					<Image Source="Images/Мозаика.png" Width="60" Height="60"/>

					<StackPanel VerticalAlignment="Center" Spacing="2">
						<TextBlock Text="Производственная компания" Foreground="Black" FontSize="18" Opacity="0.8"/>
						<TextBlock Text="«Мозаика»" Foreground="Black" FontSize="18" FontWeight="Bold"/>
					</StackPanel>
				</StackPanel>
			</Grid>
		</Border>
		<ScrollViewer>
			<StackPanel>
				<StackPanel Margin="16">
					<TextBlock Text="Материалы" Foreground="Black" FontSize="22" FontWeight="SemiBold" Margin="0,0,0,10"/>
					<Button Name="BtnAddMaterial" Content="Добавить материал" Click="BtnAddMaterial_Click" Padding="10,5"/>
				</StackPanel>
				<ListBox Name="MaterialsList"
						 Margin="16,5,16,16"
						 Background="Transparent"
						 BorderThickness="0"
						 SelectionMode="Single"
						 DoubleTapped="MaterialsList_DoubleTapped"
						 SelectionChanged="MaterialsList_SelectionChanged">
					<ListBox.Styles>
						<Style Selector="ListBoxItem">
							<Setter Property="Background" Value="Transparent"/>
							<Setter Property="BorderThickness" Value="0"/>
							<Setter Property="Padding" Value="0"/>
							<Setter Property="Margin" Value="0"/>
						</Style>
						<Style Selector="ListBoxItem:selected">
							<Setter Property="Background" Value="Transparent"/>
						</Style>
						<Style Selector="ListBoxItem:pointerover">
							<Setter Property="Background" Value="Transparent"/>
						</Style>
					</ListBox.Styles>
					<ListBox.ItemTemplate>
						<DataTemplate>
							<Border BorderBrush="#CCCCCC" BorderThickness="1"
									CornerRadius="4"
									Margin="0,0,0,12"
									Padding="16"
									Background="White">
								<Grid ColumnDefinitions="*,Auto">
									<StackPanel Grid.Column="0" Spacing="8">
										<TextBlock FontSize="16" FontWeight="Bold" Margin="0,0,0,8">
											<Run Text="{Binding MaterialTypeName}"/>
											<Run Text=" | "/>
											<Run Text="{Binding Name}"/>
										</TextBlock>

										<StackPanel Spacing="4">
											<TextBlock>
												<Run Text="Минимальное количество: " FontWeight="SemiBold"/>
												<Run Text="{Binding MinQuantity, StringFormat='{}{0:F2}'}"/>
												<Run Text=" "/>
												<Run Text="{Binding MeasurementName}"/>
											</TextBlock>

											<TextBlock>
												<Run Text="Количество на складе: " FontWeight="SemiBold"/>
												<Run Text="{Binding StockQuantity, StringFormat='{}{0:F2}'}"/>
												<Run Text=" "/>
												<Run Text="{Binding MeasurementName}"/>
											</TextBlock>

											<TextBlock>
												<Run Text="Цена: " FontWeight="SemiBold"/>
												<Run Text="{Binding UnitPrice, StringFormat='{}{0:F2}'}"/>
												<Run Text=" р / Единица измерения: "/>
												<Run Text="{Binding MeasurementName}"/>
											</TextBlock>

											<StackPanel IsVisible="{Binding NeedsRestock}" Spacing="2">
												<TextBlock Foreground="#ff2a00">
													<Run Text="Недостаток: " FontWeight="SemiBold"/>
													<Run Text="{Binding FormattedDeficit}"/>
													<Run Text=" "/>
													<Run Text="{Binding MeasurementName}"/>
												</TextBlock>
												<TextBlock>
													<Run Text="Минимальный объем закупки: " FontWeight="SemiBold"/>
													<Run Text="{Binding FormattedPurchaseQuantity}"/>
													<Run Text=" "/>
													<Run Text="{Binding MeasurementName}"/>
													<Run Text=" ("/>
													<Run Text="{Binding FormattedPackagesNeeded}"/>
													<Run Text=" упаковок)"/>
												</TextBlock>
											</StackPanel>
											<TextBlock IsVisible="{Binding HasSufficientStock}" Foreground="#2E7D32">
												<Run Text="Запас материала достаточен."/>
											</TextBlock>
										</StackPanel>
									</StackPanel>

									<StackPanel Grid.Column="1" HorizontalAlignment="Right" VerticalAlignment="Top" Spacing="8">
										<Border IsVisible="{Binding NeedsRestock}" 
												BorderBrush="#ff2a00"
												BorderThickness="1" 
												CornerRadius="4"
												Padding="10">
											<StackPanel Spacing="4">
												<TextBlock FontSize="14" FontWeight="Bold" Foreground="#ff2a00">Требуется закупка!</TextBlock>
												<TextBlock FontSize="14" Foreground="#ff2a00">
													<Run Text="Количество: " FontWeight="SemiBold"/>
													<Run Text="{Binding FormattedPurchaseQuantity}"/>
													<Run Text=" "/>
													<Run Text="{Binding MeasurementName}"/>
												</TextBlock>
												<TextBlock FontSize="14" Foreground="#ff2a00">
													<Run Text="Упаковок: " FontWeight="SemiBold"/>
													<Run Text="{Binding FormattedPackagesNeeded}"/>
												</TextBlock>
												<TextBlock FontSize="15" FontWeight="Bold" Foreground="#ff2a00" Margin="0,4,0,0">
													<Run Text="Сумма: "/>
													<Run Text="{Binding FormattedBatchCost}"/>
													<Run Text=" р"/>
												</TextBlock>
											</StackPanel>
										</Border>
										<StackPanel Orientation="Horizontal" Spacing="8" Margin="0,4,0,0">
											<Button Name="BtnEdit" Content="Редактировать" Tag="{Binding}" Click="BtnEdit_Click" Padding="8,4"/>
											<Button Name="BtnSuppliers" Content="Поставщики" Tag="{Binding}" Click="BtnSuppliers_Click" Padding="8,4"/>
										</StackPanel>
									</StackPanel>
								</Grid>
							</Border>
						</DataTemplate>
					</ListBox.ItemTemplate>
				</ListBox>
			</StackPanel>

		</ScrollViewer>
	</DockPanel>
</Window>
